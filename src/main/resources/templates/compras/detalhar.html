<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Detalhes da Compra</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .container { background: rgba(255,255,255,0.97); border-radius: 20px; box-shadow: 0 15px 35px rgba(0,0,0,0.1); padding: 30px; margin-top: 20px; margin-bottom: 20px; backdrop-filter: blur(10px); }
        h2 { color: #2c3e50; font-weight: 600; margin-bottom: 30px; text-align: center; }
        .btn { border-radius: 25px; padding: 12px 30px; font-weight: 600; transition: all 0.3s ease; border: none; text-transform: uppercase; letter-spacing: 0.5px; font-size: 0.95rem; margin-right: 10px; }
        .btn-secondary { background: linear-gradient(45deg, #6c757d, #495057); box-shadow: 0 4px 15px rgba(108,117,125,0.3); }
        .btn-secondary:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(108,117,125,0.4); }
        .table { background: white; border-radius: 15px; overflow: hidden; box-shadow: 0 8px 25px rgba(0,0,0,0.1); margin-top: 20px; }
        .table thead th { background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; padding: 15px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; font-size: 0.85rem; }
        .table tbody tr { transition: all 0.3s ease; }
        .table tbody tr:hover { background: linear-gradient(135deg, #f8f9fa, #e9ecef); transform: scale(1.01); }
        .table tbody td { padding: 15px; border: none; border-bottom: 1px solid #dee2e6; vertical-align: middle; }
        .text-center { text-align: center; }
        .text-muted { color: #6c757d !important; font-style: italic; }
        @media (max-width: 768px) { .container { margin: 10px; padding: 20px; } .table-responsive { border-radius: 15px; overflow: hidden; } .btn { margin-bottom: 10px; width: 100%; } }
    </style>
</head>
<body>
    <div class="container mt-4">
        <h2>Detalhes da Compra</h2>
        <div class="mb-3">
            <a href="/" class="btn btn-secondary">Voltar</a>
        </div>
        <div class="mb-4">
            <strong>Fornecedor:</strong> <span th:text="${compra.fornecedor.nome}"></span><br>
            <strong>Data da Compra:</strong> <span th:text="${#temporals.format(compra.dataCompra, 'dd/MM/yyyy HH:mm')}"></span><br>
            <strong>Valor Total:</strong> <span th:text="${#numbers.formatCurrency(compra.valorTotal)}"></span><br>
            <strong>ICMS Crédito:</strong> <span th:text="${#numbers.formatCurrency(compra.valorIcmsCredito)}"></span><br>
            <strong>Forma de Pagamento:</strong> <span th:text="${compra.formaPagamento}"></span><br>
            <strong>Parcelas Pagas:</strong> <span th:text="${compra.parcelasPagas}"></span> / <span th:text="${compra.parcelas}"></span><br>
            <strong>Valor da Parcela:</strong> <span th:text="${#numbers.formatCurrency(compra.valorTotal / compra.parcelas)}"></span><br>
            <strong>Saldo Devedor:</strong> <span th:text="${#numbers.formatCurrency(compra.saldoDevedor)}"></span>
            <div th:if="${compra.saldoDevedor > 0}">
                <form th:action="@{'/compras/' + ${compra.id} + '/pagar-parcela'}" method="post" style="display:inline;">
                    <label for="qtdParcelas" class="form-label">Qtd. de parcelas a pagar:</label>
                    <input type="number" min="1" th:attr="max=${compra.parcelas - compra.parcelasPagas}" name="qtdParcelas" id="qtdParcelas" value="1" style="width: 80px; display: inline-block; margin-right: 10px;">
                    <button type="submit" class="btn btn-success mt-2">
                        Pagar <span th:text="${qtdParcelas != null ? qtdParcelas : 1}"></span> Parcela(s) (<span th:text="${#numbers.formatCurrency((compra.valorTotal / compra.parcelas) * (qtdParcelas != null ? qtdParcelas : 1))}"></span>)
                    </button>
                </form>
            </div>
        </div>
        <div class="table-responsive">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Produto</th>
                        <th>Quantidade</th>
                        <th>Valor Unitário</th>
                        <th>Valor Total</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="item : ${compra.itensCompra}">
                        <td th:text="${item.produto.nome}"></td>
                        <td th:text="${item.quantidade}"></td>
                        <td th:text="${#numbers.formatCurrency(item.valorUnitario)}"></td>
                        <td th:text="${#numbers.formatCurrency(item.valorTotal)}"></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html> 